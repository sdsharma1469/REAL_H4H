<!DOCTYPE html>
<head>
<link rel="stylesheet" href="mainPage.css">
<title>Farm Fast</title>
</head>
<body>
<h1> <center>Farm Fast </center></h1>

<div class="header">
  <img src="Logo.jpg" alt="Farm Fast Logo">
</div>
<section>
  <h2>Add Your Product</h2>
  <form id="productForm">
    <label for="productName">Product Name:</label>
    <input type="text" id="productName" name="productName" required>

    <label for="productPrice">Price:</label>
    <input type="number" id="productPrice" name="productPrice" required>

    <label for="productQuantity">Quantity (in kg):</label>
    <input type="number" id="productQuantity" name="productQuantity" required>

    <label for="productContact">Contact:</label>
    <input type="text" id="productContact" name="productContact" required>

    <button type="button" id="addProduct">Add Product</button>
  </form>
</section>

<section>
  <h2>Products Available</h2>
  <div id="productList">
    <!-- Products will be listed here -->
  </div>
</section>

<script>

window.onload = function() {
  console.log("Page loaded");

  fetch('http://127.0.0.1:5000/print')
  .then(response => {
    if (!response.ok) {
      throw new Error('Network response was not ok');
    }
    return response.json(); 
  })
  .then(data => {
    console.log(data); 
    alert('GET request successful.'); 

    var productListDiv = document.getElementById('productList');
    data.forEach(function(item) {
      var productDiv = document.createElement('div');
      productDiv.classList.add('product-item');
      productDiv.innerHTML = `
        <div class="box product-box">
          <table border="1" cellspacing="0" cellpadding="10">
              <tr>
                  <td>
                      <p><strong>Product Name:</strong> ${item.name}</p>
                      <p><strong>Price:</strong> ${item.price}</p>
                      <p><strong>Quantity:</strong> ${item.quantity}</p>
                      <p><strong>Contact:</strong> ${item.contact}</p>
                  </td>
              </tr>
          </table>
        </div>
      `;
      productListDiv.appendChild(productDiv);
    });
  })
  .catch(error => {
    console.error('Error:', error);
    alert('An error occurred.');
  });
};


document.getElementById('addProduct').addEventListener('click', function() {
    var productName = document.getElementById('productName').value;
    var productPrice = document.getElementById('productPrice').value;
    var productQuantity = document.getElementById('productQuantity').value;
    var productContact = document.getElementById('productContact').value;
    var data = {
        productName: productName,
        productPrice: productPrice,
        productQuantity: productQuantity,
        productContact: productContact
    };

    fetch('http://127.0.0.1:5000/add', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify(data)
    })
    .then(response => response.text())
    .then(data => {
        console.log(data);
        alert('POST request sent successfully.');
    })
    .catch(error => {
        console.error('Error:', error);
        alert('An error occurred.');
    });
});

</script>

</body>
</html>